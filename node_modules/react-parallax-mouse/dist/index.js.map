{"version":3,"file":"index.js","sources":["../src/defaults.ts","../src/Context.tsx","../src/Child.tsx","../src/Container.tsx"],"sourcesContent":["import { SpringValue } from \"react-spring\";\r\n\r\n// Defaults\r\nexport const defaultSpring = { x: 0, y: 0 };\r\nexport const defaultSpringValue = { x: new SpringValue(0), y: new SpringValue(0) };\r\n","import { createContext, useContext } from \"react\";\r\nimport { defaultSpringValue } from \"./defaults\";\r\nimport { SpringPosition } from \"./interfaces\";\r\n\r\n// Parallax Context\r\nexport const OffsetContext = createContext<SpringPosition>(defaultSpringValue);\r\nexport const useParallaxOffset = () => useContext(OffsetContext);\r\n","import React, { useCallback } from \"react\";\r\nimport { animated } from \"react-spring\";\r\nimport { useParallaxOffset } from \"./Context\";\r\nimport { SpringPosition } from \"./interfaces\";\r\n\r\ninterface Props {\r\n  factorX?: number;\r\n  factorY?: number;\r\n  inverted?: boolean;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n  children?: JSX.Element | JSX.Element[];\r\n}\r\n\r\nconst MouseParallaxChild = ({\r\n  factorX = 1,\r\n  factorY = 1,\r\n  inverted = false,\r\n  className,\r\n  style,\r\n  children,\r\n}: Props) => {\r\n  const offset = useParallaxOffset();\r\n  const calculateChildOffset = useCallback(\r\n    (offset: SpringPosition) => {\r\n      const calcX = (x: number) => x * factorX * (inverted ? -1 : 1);\r\n      const calcY = (y: number) => y * factorY * (inverted ? -1 : 1);\r\n      return { x: offset.x.to(calcX), y: offset.y.to(calcY) };\r\n    },\r\n    [factorX, factorY]\r\n  );\r\n\r\n  const divStyle = {\r\n    ...calculateChildOffset(offset),\r\n    ...style,\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <animated.div {...{ className }} style={divStyle}>\r\n        {children}\r\n      </animated.div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport { MouseParallaxChild };\r\n","import React, { useCallback, useEffect, useState } from \"react\";\r\nimport { SpringConfig, useSpring } from \"react-spring\";\r\nimport { OffsetContext } from \"./Context\";\r\nimport { defaultSpring } from \"./defaults\";\r\nimport { Position } from \"./interfaces\";\r\n\r\ninterface Props {\r\n  globalFactorX?: number;\r\n  globalFactorY?: number;\r\n  resetOnLeave?: boolean;\r\n  useWindowMouseEvents?: boolean;\r\n  inverted?: boolean;\r\n  springConfig?: SpringConfig;\r\n  enabled?: boolean;\r\n  containerStyle?: React.CSSProperties;\r\n  className?: string;\r\n  children: JSX.Element[] | JSX.Element;\r\n}\r\n\r\nconst MouseParallaxContainer = ({\r\n  globalFactorX = 1,\r\n  globalFactorY = 1,\r\n  resetOnLeave,\r\n  useWindowMouseEvents,\r\n  inverted,\r\n  springConfig,\r\n  enabled = true,\r\n  containerStyle,\r\n  className,\r\n  children,\r\n}: Props) => {\r\n  const [offset, offsetApi] = useSpring(() => ({\r\n    ...defaultSpring,\r\n    ...(springConfig ? { config: springConfig } : {}),\r\n  }));\r\n  const resetOffset = () => offsetApi.start(defaultSpring);\r\n\r\n  const [containerRef, setContainerRef] = useState<{\r\n    current: HTMLDivElement | null;\r\n  }>({ current: null });\r\n  const containerRefWithCallback = useCallback((node: any) => {\r\n    if (node !== null) {\r\n      setContainerRef({ current: node });\r\n    }\r\n  }, []);\r\n\r\n  const getMousePosition = useCallback(\r\n    (\r\n      event: React.MouseEvent<HTMLDivElement, MouseEvent> | MouseEvent\r\n    ): Position => {\r\n      const rect = containerRef.current\r\n        ? containerRef.current.getBoundingClientRect()\r\n        : { left: 0, top: 0 };\r\n      return { x: event.clientX - rect.left, y: event.clientY - rect.top };\r\n    },\r\n    [containerRef]\r\n  );\r\n\r\n  const mouseMovementHandler = useCallback(\r\n    (event: React.MouseEvent<HTMLDivElement, MouseEvent> | MouseEvent) => {\r\n      if (containerRef.current) {\r\n        const containerHeight = containerRef.current.clientHeight;\r\n        const containerWidth = containerRef.current.clientWidth;\r\n        const mousePosition = getMousePosition(event);\r\n        const offsetRelativeToCenter: Position = {\r\n          x:\r\n            (containerWidth / 2 - mousePosition.x) *\r\n            globalFactorX *\r\n            (inverted ? -1 : 1),\r\n          y:\r\n            (containerHeight / 2 - mousePosition.y) *\r\n            globalFactorY *\r\n            (inverted ? -1 : 1),\r\n        };\r\n        offsetApi.start(offsetRelativeToCenter);\r\n      }\r\n    },\r\n    [containerRef, getMousePosition, inverted]\r\n  );\r\n\r\n  // Use window event handler when useWindowMouseEvents is enabled\r\n  useEffect(() => {\r\n    if (enabled && useWindowMouseEvents && containerRef.current) {\r\n      window.addEventListener(\"mousemove\", mouseMovementHandler, false);\r\n      if (resetOnLeave) {\r\n        window.addEventListener(\"mouseout\", resetOffset, false);\r\n      }\r\n    }\r\n    return () => {\r\n      if (enabled && useWindowMouseEvents && containerRef.current) {\r\n        window.removeEventListener(\"mousemove\", mouseMovementHandler, false);\r\n        if (resetOnLeave) {\r\n          window.removeEventListener(\"mouseout\", resetOffset, false);\r\n        }\r\n      }\r\n    };\r\n  }, [\r\n    containerRef,\r\n    mouseMovementHandler,\r\n    resetOnLeave,\r\n    useWindowMouseEvents,\r\n    enabled,\r\n  ]);\r\n\r\n  const useMouseMoveHandler = enabled && !useWindowMouseEvents;\r\n  const useMouseLeaveHandler = enabled && !useWindowMouseEvents && resetOnLeave;\r\n  const divEvents = {\r\n    onMouseMove: useMouseMoveHandler ? mouseMovementHandler : undefined,\r\n    onMouseLeave: useMouseLeaveHandler ? resetOffset : undefined,\r\n  };\r\n\r\n  return (\r\n    <OffsetContext.Provider value={offset}>\r\n      <div\r\n        id=\"mouse-parallax-container\"\r\n        ref={containerRefWithCallback}\r\n        style={{ overflow: \"hidden\", position: \"relative\", ...containerStyle }}\r\n        {...{ className }}\r\n        {...divEvents}\r\n      >\r\n        {children}\r\n      </div>\r\n    </OffsetContext.Provider>\r\n  );\r\n};\r\n\r\nexport { MouseParallaxContainer };\r\n"],"names":["defaultSpring","x","y","defaultSpringValue","SpringValue","OffsetContext","createContext","useParallaxOffset","useContext","_a","_b","factorX","_c","factorY","_d","inverted","className","style","children","offset","calculateChildOffset","useCallback","to","divStyle","React","createElement","Fragment","animated","div","globalFactorX","globalFactorY","resetOnLeave","useWindowMouseEvents","springConfig","enabled","containerStyle","_e","useSpring","__assign","config","offsetApi","resetOffset","start","_f","useState","current","containerRef","setContainerRef","containerRefWithCallback","node","getMousePosition","event","rect","getBoundingClientRect","left","top","clientX","clientY","mouseMovementHandler","containerHeight","clientHeight","containerWidth","clientWidth","mousePosition","offsetRelativeToCenter","useEffect","window","addEventListener","removeEventListener","divEvents","onMouseMove","undefined","onMouseLeave","Provider","value","id","ref","overflow","position"],"mappings":"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"}